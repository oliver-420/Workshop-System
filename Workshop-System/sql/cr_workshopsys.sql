CREATE TABLE Mechanic
(
    ID         INT GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NAME       varchar(20),
    HOURLY_PAY numeric
);

CREATE TABLE Task
(
    ID          INT GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NAME        varchar(20),
    DESCRIPTION varchar(100),
    START_DATE  DATE,
    HOURS       NUMERIC,
    MECHANIC_ID INT NOT NULL
);

create TABLE MechanicTaskMapping
(
    ID          INT GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    MECHANIC_ID INT NOT NULL,
    TASK_ID     INT NOT NULL,
    CONSTRAINT MECHANIC_TASK_MAPPING_MECHANIC_FK FOREIGN KEY (MECHANIC_ID) REFERENCES Mechanic (ID),
    CONSTRAINT MECHANIC_TASK_MAPPING_TASK_FK FOREIGN KEY (TASK_ID) REFERENCES Task (ID)

);

CREATE TABLE CustomerCard
(
    ID        INT GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    DISCOUNT  numeric,
    JOINED_AT DATE

);

CREATE TABLE Customer
(
    ID               INT GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NAME             varchar(20),
    EMAIL            varchar(20),
    PHONE_NUMBER     varchar(20),
    DATE_OF_BIRTH    DATE,
    CUSTOMER_CARD_ID INT NOT NULL
        CONSTRAINT C_FR_CK REFERENCES CustomerCard (ID)
);


CREATE TABLE Part
(
    SERIAL_NUMBER VARCHAR(20) NOT NULL PRIMARY KEY,
    NAME          varchar(20),
    MANUFACTURER  varchar(20),
    PRICE         numeric,
    UP_CHARGE     numeric,
    COUNT         INT
);

create TABLE TaskPartMapping
(
    ID         INT GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    TASK_ID    INT         NOT NULL,
    PART_ID    VARCHAR(20) NOT NULL,
    CONSTRAINT TASK_PART_MAPPING_TASK_FK FOREIGN KEY (TASK_ID) REFERENCES Task (ID),
    CONSTRAINT TASK_PART_MAPPING_PART_FK FOREIGN KEY (PART_ID) REFERENCES Part (SERIAL_NUMBER),
    PART_COUNT INT,
    PRICE      numeric
);

CREATE TABLE Car
(
    ID                INT GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    MODEL             varchar(50),
    MANUFACTURER      varchar(50),
    PRODUCTION_YEAR   numeric,
    REGISTRATION_YEAR numeric,
    OWNER_NAME        varchar(50),
    FUEL_TYPE         varchar(20),
    NUMBER_PLATE      varchar(20)
);

CREATE TABLE Invoice
(
    ID          INT GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    DATE        DATE,
    AMOUNT      numeric,
    IS_PAID     BOOLEAN,
    TASK_ID     INT NOT NULL
        CONSTRAINT T_FR_CK REFERENCES Task (ID),
    CUSTOMER_ID INT NOT NULL
        CONSTRAINT I_FR_CK REFERENCES Customer (ID)
);